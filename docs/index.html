<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Drop voicings visualizer</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="./style.css" />
  <script defer type="module" src="./bundle.js"></script>
</head>
<body>
  <header class="site-header">
    <div class="brand">
      <span class="logo" aria-hidden="true">♭♯</span>
      <div class="titles">
        <h1>Drop voicings visualizer</h1>
        <p class="tagline">Compose and save your chords!</p>
      </div>
    </div>
    <div class="header-actions">
      <button id="open-builder" type="button" class="builder-button">
        <span aria-hidden="true">⚡</span>
        Create New Chord
      </button>
      <button id="add-empty-chord" type="button" class="builder-button secondary">
        <span aria-hidden="true">◯</span>
        Add Empty Chord
      </button>
    </div>
  </header>
  
  <section class="intro" id="intro">
    <p>This is your saved chords gallery. Each entry shows an individual chord diagram you've created and saved. Click "Create New Chord" to open the chord builder where you can select intervals, voicings, and string sets to generate new chord diagrams.</p>
  </section>

  <section id="cart-gallery" class="cart-gallery" aria-live="polite">
    <div class="gallery-header">
        <h2>Saved Chords (<span id="cart-count">0</span>)</h2>
      <div class="gallery-actions">
        <button type="button" id="cart-empty" class="secondary" disabled>Empty All</button>
        <button type="button" id="cart-download-html" disabled>Save as HTML</button>
        <div class="show-as-wrapper">
          <button type="button" id="show-as-btn" class="secondary" aria-haspopup="true" aria-expanded="false" aria-controls="show-as-menu" disabled>Export as ▾</button>
          <div id="show-as-menu" role="menu" aria-label="Show as menu" hidden>
            <button type="button" role="menuitem" data-format="text">Text</button>
            <button type="button" role="menuitem" data-format="json">JSON</button>
          </div>
        </div>
        <div class="import-from-wrapper">
          <button type="button" id="import-from-btn" class="secondary" aria-haspopup="true" aria-expanded="false" aria-controls="import-from-menu">Import from ▾</button>
          <div id="import-from-menu" role="menu" aria-label="Import from menu" hidden>
            <button type="button" role="menuitem" data-format="text">Text</button>
            <button type="button" role="menuitem" data-format="json">JSON</button>
          </div>
        </div>
      </div>
    </div>
    <div id="cart-items" class="cart-items">
      <div class="empty-state">
        <p>No chords saved yet.</p>
        <p>Click "Create New Chord" above to get started!</p>
      </div>
    </div>
  </section>

  <aside id="builder-panel" class="builder-panel" role="dialog" aria-label="Chord Builder" aria-hidden="true">
    <div class="builder-content">
      <header class="builder-header">
        <h2>Chord Builder</h2>
        <button id="close-builder" type="button" class="close-button" aria-label="Close builder">×</button>
      </header>
      
      <form id="voicing-form">
        <fieldset class="group">
          <legend>1. Select Intervals</legend>
          <p class="hint">Choose up to 6 unique intervals (unordered). Order and voicing are applied later.</p>
          <div class="preset-selector">
            <label for="interval-preset">Presets:</label>
            <select id="interval-preset" class="preset-dropdown">
              <option value="">Choose a preset...</option>
            </select>
          </div>
          <div id="interval-box" class="selectors"></div>
        </fieldset>

        <fieldset class="group">
          <legend>2. Interval Labels</legend>
          <p class="hint">Optional: Set a short label (max 3 chars) and choose whether to color each selected interval.</p>
          <div id="interval-label-options" class="interval-label-options"></div>
        </fieldset>

        <fieldset class="group">
          <legend>3. Voicing</legend>
          <div id="voicing-box" class="selectors"></div>
        </fieldset>

        <fieldset class="group">
          <legend>4. String Set</legend>
          <p class="hint" id="strings-hint">Select intervals first to see valid string sets.</p>
          <div id="stringset-box" class="selectors"></div>
        </fieldset>

        <fieldset class="group">
          <legend>5. Filter doable chords</legend>
          <p class="hint">Filter chords that are physically playable (fret span ≤ 5, unique frets ≤ 4).</p>
          <label class="check-wrap">
            <input type="checkbox" id="filter-doable-checkbox" checked />
            <span>Show only doable chords</span>
          </label>
        </fieldset>
      </form>

      <div id="message" class="message" aria-live="polite"></div>
      <div id="results" class="results" aria-live="polite"></div>
    </div>
  </aside>

  <div id="export-overlay" class="export-overlay" role="dialog" aria-labelledby="export-overlay-title" aria-hidden="true" hidden>
    <div class="export-overlay-backdrop"></div>
    <div class="export-overlay-content">
      <header class="export-overlay-header">
        <h2 id="export-overlay-title">Export Content</h2>
        <button id="export-overlay-close" type="button" class="close-button" aria-label="Close export overlay">×</button>
      </header>
      <div class="export-overlay-body">
        <pre id="export-overlay-text" class="export-text"></pre>
      </div>
      <footer class="export-overlay-footer">
        <div class="column-controls">
          <span class="column-label">Columns:</span>
          <button id="export-column-decrement" type="button" class="column-btn" aria-label="Decrease columns">−</button>
          <span id="export-column-count" class="column-count">3</span>
          <button id="export-column-increment" type="button" class="column-btn" aria-label="Increase columns">+</button>
        </div>
        <div id="format-toggle" class="format-toggle" hidden>
          <button id="format-ascii" type="button" class="format-btn" data-format="ascii">ASCII</button>
          <button id="format-unicode" type="button" class="format-btn active" data-format="unicode">Unicode</button>
        </div>
        <button id="export-overlay-copy" type="button" class="primary">Copy to Clipboard</button>
      </footer>
    </div>
  </div>

  <div id="title-modal" class="title-modal" role="dialog" aria-labelledby="title-modal-title" aria-hidden="true" hidden>
    <div class="title-modal-backdrop"></div>
    <div class="title-modal-content">
      <header class="title-modal-header">
        <h2 id="title-modal-title">Export HTML</h2>
        <button id="title-modal-close" type="button" class="close-button" aria-label="Close dialog">×</button>
      </header>
      <div class="title-modal-body">
        <label for="html-title-input" class="title-label">Enter a title for your chord collection:</label>
        <input type="text" id="html-title-input" class="title-input" maxlength="50" placeholder="My Chords" />
        <div class="char-counter" aria-live="polite"><span id="char-count">50</span> characters remaining</div>
      </div>
      <footer class="title-modal-footer">
        <button id="title-modal-cancel" type="button" class="secondary">Cancel</button>
        <button id="title-modal-export" type="button" class="primary">Export</button>
      </footer>
    </div>
  </div>

  <div id="import-overlay" class="import-overlay" role="dialog" aria-labelledby="import-overlay-title" aria-hidden="true" hidden>
    <div class="import-overlay-backdrop"></div>
    <div class="import-overlay-content">
      <header class="import-overlay-header">
        <h2 id="import-overlay-title">Import Chords</h2>
        <button id="import-overlay-close" type="button" class="close-button" aria-label="Close import overlay">×</button>
      </header>
      <div class="import-overlay-body">
        <textarea id="import-textarea" class="import-textarea" placeholder="Paste JSON or text chord diagrams here..."></textarea>
        <div id="import-message" class="import-message" aria-live="polite"></div>
      </div>
      <footer class="import-overlay-footer">
        <button id="import-overlay-import" type="button" class="primary">Import</button>
      </footer>
    </div>
  </div>

  <footer class="site-footer">
    <p class="meta">© 2025 <span class="author">Maurizio Lupo</span> · <a href="https://github.com/sithmel/chord-renderer" target="_blank" rel="noopener">GitHub</a></p>
  </footer>
</body>
</html>
